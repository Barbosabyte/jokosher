#!/usr/bin/env python

import os, sys
#Change this variable when packaging
JOKOSHER_DIR = os.path.dirname(os.path.abspath(__file__))
sys.path.append(JOKOSHER_DIR)

import locale, gettext, optparse, Globals
_ = gettext.gettext

try:
	locale.setlocale(locale.LC_ALL, '')
	gettext.bindtextdomain(Globals.LOCALE_APP, Globals.LOCALE_DIR)
	gettext.bind_textdomain_codeset(Globals.LOCALE_APP, "UTF-8");
	gettext.textdomain(Globals.LOCALE_APP)
except locale.Error:
	print "Locale unsupported, defaulting to english for all Jokosher specific text"
	
# parse command line
openproject = None
parser = optparse.OptionParser(usage="%prog [options] [project-file]", version="0.2-SVN")

#command line options
parser.add_option("-d", "--debug", action="store_true", dest="debug", 
				help=_("Print debug output to stdout"))
parser.add_option("-g", "--gst-debug", action="store_true", dest="gstDebug", 
				help=_("Sent debug output to Gstreamer's debug system"))
parser.add_option("-s", "--safe-mode", action="store_true", dest="safeMode", 
				help=_("Don't load extensions or last project on startup"))
parser.add_option("-w", "--welcome-dialog", action="store_true", dest="forceWelcome", 
				help=_("Force the welcome dialog to show on startup"))

(options, args) = parser.parse_args()
if len(args) > 0:
	openproject = args[0]
	
Globals.DEBUG_STDOUT = options.debug
Globals.DEBUG_GST = options.gstDebug

try:
	import JokosherApp
except:
	print _("Cannot find %s") % "JokosherApp.py"
	sys.exit()
	
#Launching the program
JokosherApp.MainApp(openproject, options.safeMode, options.forceWelcome)
JokosherApp.gtk.threads_init()
JokosherApp.gtk.main()
